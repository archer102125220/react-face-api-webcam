(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(e,t){},109:function(e,t){},142:function(e,t){},143:function(e,t){},191:function(e,t,n){"use strict";n.r(t);var a,i,r=n(3),c=n.n(r),s=n(86),o=n.n(s),u=(n(93),n(14)),d=n.n(u),h=n(34),l=n(28),m=n(29),f=n(32),v=n(30),p=n(33),w=(n(97),n(87)),E=n.n(w),k=(n(99),r.Component,n(101),n(6)),T=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(f.a)(this,Object(v.a)(t).call(this))).state={selectedFaceDetector:"SSD_MOBILENETV1",FaceDetector:{SSD_MOBILENETV1:"SSD_MOBILENETV1",TINY_FACE_DETECTOR:"TINY_FACE_DETECTOR",MTCNN:"MTCNN"},minConfidence:.5,inputSize:512,scoreThreshold:.5,minFaceSize:20,withFaceLandmarks:!0,withBoxes:!0,forwardTimes:[],time:0,fps:0},e}return Object(p.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){a=document.getElementById("inputVideo"),i=document.getElementById("overlay"),this.initDevices()}},{key:"initDevices",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.changeFaceDetector(this.state.FaceDetector.TINY_FACE_DETECTOR);case 2:return e.next=4,navigator.mediaDevices.getUserMedia({video:{}});case 4:t=e.sent,a.srcObject=t;case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"changeFaceDetector",value:function(){var e=Object(h.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isFaceDetectionModelLoaded()){e.next=7;break}return e.next=3,this.getCurrentFaceDetectionNet().load("/weights");case 3:return e.next=5,k.h.faceLandmark68Net.load("/weights");case 5:return e.next=7,k.h.faceRecognitionNet.load("/weights");case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onPlay",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t,n,r,c,s,o=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.paused&&!a.ended&&this.isFaceDetectionModelLoaded()){e.next=2;break}return e.abrupt("return",setTimeout(function(){return o.onPlay()}));case 2:if(t=this.getFaceDetectorOptions(),n=Date.now(),r=k.d(a,t),!this.state.withFaceLandmarks){e.next=11;break}return e.next=8,r.withFaceLandmarks();case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,r;case 13:e.t0=e.sent;case 14:c=e.t0,this.updateTimeStats(Date.now()-n),s=this.state.withFaceLandmarks?this.drawLandmarks.bind(this):this.drawDetections.bind(this),c&&s(a,i,[c],this.state.withBoxes),setTimeout(function(){return o.onPlay()});case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"drawDetections",value:function(e,t,n){var a=this.resizeCanvasAndResults(e,t,n);k.e(t,a)}},{key:"drawLandmarks",value:function(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];try{var i=this.resizeCanvasAndResults(e,t,n);a&&k.e(t,i.map(function(e){return e.detection}));var r=i.map(function(e){return e.landmarks});k.f(t,r,{lineWidth:2,drawLines:!0,color:"#ff0"})}catch(c){}}},{key:"resizeCanvasAndResults",value:function(e,t,n){var a=e instanceof HTMLVideoElement?k.g(e):e,i=a.width,r=a.height;return t.width=i,t.height=r,n.map(function(e){return e.forSize(i,r)})}},{key:"updateTimeStats",value:function(e){var t=this.state.forwardTimes;this.setState({forwardTimes:[e].concat(t).slice(0,30)});var n=this.state.forwardTimes.reduce(function(e,t){return e+t})/this.state.forwardTimes.length;this.setState({time:Math.round(n),fps:k.i(1e3/n)})}},{key:"isFaceDetectionModelLoaded",value:function(){return!!this.getCurrentFaceDetectionNet().params}},{key:"getCurrentFaceDetectionNet",value:function(){var e=this.state,t=e.selectedFaceDetector,n=e.FaceDetector;switch(t){case n.SSD_MOBILENETV1:return k.h.ssdMobilenetv1;case n.TINY_FACE_DETECTOR:return k.h.tinyFaceDetector;case n.MTCNN:return k.h.mtcnn;default:return null}}},{key:"getFaceDetectorOptions",value:function(){var e=this.state,t=e.selectedFaceDetector,n=e.FaceDetector,a=e.minConfidence,i=e.inputSize,r=e.scoreThreshold,c=e.minFaceSize;return t===n.SSD_MOBILENETV1?new k.b({minConfidence:a}):t===n.TINY_FACE_DETECTOR?new k.c({inputSize:i,scoreThreshold:r}):new k.a({minFaceSize:c})}},{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"App"},c.a.createElement("div",{className:"face"},c.a.createElement("video",{onPlay:this.onPlay.bind(this),id:"inputVideo",autoPlay:!0,muted:!0}),c.a.createElement("canvas",{id:"overlay"}),c.a.createElement("div",{className:"state"},c.a.createElement("span",null,"Time: ",this.state.time," ms"),c.a.createElement("span",null,"Estimated Fps: ",this.state.fps)),c.a.createElement("div",{className:"control"},c.a.createElement("input",{id:"lbmarks",type:"checkbox",checked:this.state.withFaceLandmarks,onChange:function(t){e.setState({withFaceLandmarks:t.target.checked})}}),c.a.createElement("label",{htmlFor:"lbmarks"},"\u81c9\u90e8\u8f2a\u5ed3"))))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},87:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},88:function(e,t,n){e.exports=n(191)},93:function(e,t,n){},97:function(e,t,n){},99:function(e,t,n){}},[[88,2,1]]]);
//# sourceMappingURL=main.50286c4b.chunk.js.map