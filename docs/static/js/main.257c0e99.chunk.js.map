{"version":3,"sources":["images/cute-eye.png","images/head.png","images/glasses.png","images/moustache.png","images/red-eye.gif","utils/resource.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","__webpack_require__","p","CuteEyeImg","Image","src","CuteEye","HeadImg","Head","GlassesImg","Glasses","MoustacheImg","Moustache","videoEl","overlay","context","RedEyeImg","RedEye","App","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","loading","selectedFaceDetector","FaceDetector","SSD_MOBILENETV1","TINY_FACE_DETECTOR","MTCNN","minConfidence","inputSize","scoreThreshold","minFaceSize","withFaceLandmarks","withBoxes","withLines","forwardTimes","time","fps","colorLandmarks","colorShow","selectedMode","value","label","modes","document","getElementById","getContext","initDevices","changeFaceDetector","navigator","mediaDevices","getUserMedia","video","stream","srcObject","detector","isFaceDetectionModelLoaded","getCurrentFaceDetectionNet","load","faceapi","faceLandmark68Net","faceRecognitionNet","clearRect","width","height","paused","ended","setTimeout","_this2","onPlay","setState","options","getFaceDetectorOptions","ts","Date","now","faceDetectionTask","result","updateTimeStats","drawFunction","drawLandmarks","bind","drawDetections","onCleanCanvas","dimensions","canvas","results","arguments","length","undefined","resizedDetections","resizeCanvasAndResults","resizedResults","map","det","faceDetection","points","drawFaceIndex","drawCuteEyes","drawEyes","drawRedEye","drawGlasses","drawMoustache","drawHead","drawDefault","e","faceLandmarks","drawLandmarksOptions","lineWidth","drawLines","color","_this3","positions","forEach","_ref","index","x","y","fillStyle","font","fillText","p1","p2","dist","Math","sqrt","pow","_points$faceLandmarks","drawImage","_points$faceLandmarks2","_points$faceLandmarks3","poitns","lp1","lp2","lx","ly","fillRect","rp1","rp2","rx","ry","_points$faceLandmarks4","_ref2","HTMLVideoElement","res","forSize","timeInMs","concat","slice","avgTimeInMs","reduce","total","t","round","params","_this$state","ssdMobilenetv1","tinyFaceDetector","mtcnn","_this$state2","_this4","react_default","a","createElement","className","react_select_esm","onChange","id","autoPlay","muted","style","display","type","checked","target","htmlFor","onClick","backgroundColor","lib","hex","Component","Boolean","window","location","hostname","match","ReactDOM","render","src_App_0","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.257c0e99.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/cute-eye.b7f35bc3.png\";","module.exports = __webpack_public_path__ + \"static/media/head.03fb4e8a.png\";","module.exports = __webpack_public_path__ + \"static/media/glasses.c3b82e8e.png\";","module.exports = __webpack_public_path__ + \"static/media/moustache.49e6cda2.png\";","module.exports = __webpack_public_path__ + \"static/media/red-eye.bd5761cb.gif\";","import CuteEye from '../images/cute-eye.png';\nimport Head from '../images/head.png';\nimport Glasses from '../images/glasses.png';\nimport Moustache from '../images/moustache.png';\nimport RedEye from '../images/red-eye.gif';\n\nexport const CuteEyeImg = new Image();\nCuteEyeImg.src = CuteEye;\n\nexport const HeadImg = new Image();\nHeadImg.src = Head;\n\nexport const GlassesImg = new Image();\nGlassesImg.src = Glasses;\n\nexport const MoustacheImg = new Image();\nMoustacheImg.src = Moustache;\n\nexport const RedEyeImg = new Image();\nRedEyeImg.src = RedEye;\n\n","import React, { Component } from 'react';\nimport './App.scss';\n\nimport { SketchPicker } from 'react-color'\nimport * as faceapi from 'face-api.js';\nimport Select from 'react-select';\n\nimport {\n  CuteEyeImg,\n  HeadImg,\n  GlassesImg,\n  MoustacheImg,\n  RedEyeImg\n} from './utils/resource';\n\nlet videoEl, overlay, context;\n\nclass App extends Component {\n\n  constructor() {\n    super();\n    this.state = {\n      loading: true,\n      selectedFaceDetector: 'SSD_MOBILENETV1',\n      FaceDetector: {\n        SSD_MOBILENETV1: 'SSD_MOBILENETV1',\n        TINY_FACE_DETECTOR: 'TINY_FACE_DETECTOR',\n        MTCNN: 'MTCNN',\n      },\n      minConfidence: 0.5,\n      inputSize: 512,\n      scoreThreshold: 0.5,\n      minFaceSize: 20,\n      withFaceLandmarks: false,\n      withBoxes: true,\n      withLines: true,\n      forwardTimes: [],\n      time: 0,\n      fps: 0,\n      colorLandmarks: '#e4e62d',\n      colorShow: false,\n      selectedMode: { value: 'default', label: '基礎繪製' },\n      modes: [\n        { value: 'default', label: '基礎繪製' },\n        { value: 'face-index', label: '臉部索引' },\n        { value: 'eyes', label: '點狀眼睛' },\n        { value: 'cute-eyes', label: '可愛眼睛' },\n        { value: 'mousetache', label: '大黑鬍子' },\n        { value: 'glasses', label: '太陽眼鏡' },\n        { value: 'red-eye', label: '血輪眼' },\n        { value: 'head', label: '川普大頭' }\n      ],\n    }\n  }\n\n  componentDidMount() {\n    videoEl = document.getElementById('inputVideo');\n    overlay = document.getElementById('overlay');\n    context = overlay.getContext('2d');\n\n    this.initDevices();\n\n    // faceapi.nets.ssdMobilenetv1\n    // faceapi.nets.mtcnn\n    // faceapi.nets.tinyFaceDetector\n    // console.log(faceapi.nets);\n  }\n\n  async initDevices() {\n    // load face detection and face landmark models\n    await this.changeFaceDetector(this.state.FaceDetector.TINY_FACE_DETECTOR)\n\n    // try to access users webcam and stream the images\n    // to the video element\n    const stream = await navigator.mediaDevices.getUserMedia({ video: {} })\n    videoEl.srcObject = stream;\n  }\n\n  async changeFaceDetector(detector) {\n    if (!this.isFaceDetectionModelLoaded()) {\n      await this.getCurrentFaceDetectionNet().load('./weights');\n      await faceapi.nets.faceLandmark68Net.load('./weights');\n      await faceapi.nets.faceRecognitionNet.load('./weights');\n    }\n  }\n\n  // 清除畫布\n  onCleanCanvas() {\n    context.clearRect(0, 0, overlay.width, overlay.height);\n  }\n\n  async onPlay() {\n    // check vedio valid\n    if (videoEl.paused || videoEl.ended || !this.isFaceDetectionModelLoaded()) {\n      return setTimeout(() => this.onPlay());\n    }\n\n    // show panel\n    if (this.state.loading) {\n      this.setState({\n        loading: false,\n      });\n    }\n\n    const options = this.getFaceDetectorOptions();\n    const ts = Date.now();\n\n    const faceDetectionTask = faceapi.detectSingleFace(videoEl, options);\n\n    const result = this.state.withFaceLandmarks\n      ? await faceDetectionTask.withFaceLandmarks()\n      : await faceDetectionTask;\n\n    this.updateTimeStats(Date.now() - ts);\n\n    // 繪製特徵\n    const drawFunction = this.state.withFaceLandmarks\n      ? this.drawLandmarks.bind(this)\n      : this.drawDetections.bind(this);\n\n    if (result)\n      drawFunction(videoEl, overlay, [result], this.state.withBoxes);\n\n    if (!this.state.withBoxes && !this.state.withFaceLandmarks)\n      this.onCleanCanvas();\n\n    setTimeout(() => this.onPlay());\n  }\n\n  // 繪製臉部外框\n  drawDetections(dimensions, canvas, results, withBoxes = true) {\n    if (withBoxes) {\n      const resizedDetections = this.resizeCanvasAndResults(dimensions, canvas, results);\n      faceapi.drawDetection(canvas, resizedDetections);\n    }\n  }\n\n  // 繪製臉部特徵\n  drawLandmarks(dimensions, canvas, results, withBoxes = true) {\n    try {\n      const resizedResults = this.resizeCanvasAndResults(dimensions, canvas, results);\n\n      if (withBoxes) {\n        faceapi.drawDetection(canvas, resizedResults.map(det => det.faceDetection))\n      }\n\n      const points = resizedResults[0];\n\n      // console.log(this.state.selectedMode);\n\n      // 模式切換\n      switch (this.state.selectedMode.value) {\n        case 'face-index': this.drawFaceIndex(points); break;\n        case 'cute-eyes': this.drawCuteEyes(points); break;\n        case 'eyes': this.drawEyes(points); break;\n        case 'red-eye': this.drawRedEye(points); break;\n        case 'glasses': this.drawGlasses(points); break;\n        case 'mousetache': this.drawMoustache(points); break;\n        case 'head': this.drawHead(points); break;\n        case 'default':\n        default: this.drawDefault(resizedResults, canvas); break;\n      }\n    } catch (e) { /* console.log(e); */ };\n  }\n\n  /**\n   * 預設輪廓\n   * @param {array} resizedResults \n   * @param {object} canvas \n   */\n  drawDefault(resizedResults, canvas) {\n    const faceLandmarks = resizedResults.map(det => det.faceLandmarks);\n    const drawLandmarksOptions = {\n      lineWidth: 2,\n      drawLines: this.state.withLines,\n      color: this.state.colorLandmarks,\n    }\n    faceapi.drawLandmarks(canvas, faceLandmarks, drawLandmarksOptions);\n  }\n\n  /**\n   * 臉部特徵索引\n   * @param {array} points \n   */\n  drawFaceIndex(points) {\n    points.faceLandmarks.positions.forEach(({ x, y }, index) => {\n      context.fillStyle = this.state.colorLandmarks;\n      context.font = '9px Changa one';\n      context.fillText(index, x, y);\n    });\n  }\n\n  /**\n   * 大黑鬍子\n   * @param {array} points \n   */\n  drawMoustache(points) {\n    try {\n      // 兩眼最遠距離作為圖片大小\n      const p1 = points.faceLandmarks.positions[36];\n      const p2 = points.faceLandmarks.positions[45];\n      const dist = Math.sqrt(Math.pow((p1.x - p2.x), 2) + Math.pow((p1.x - p2.x), 2), 0.5) * 0.8;\n      // 人中位置\n      const { x, y } = points.faceLandmarks.positions[51];\n      context.drawImage(MoustacheImg, x - dist / 20 * 10, y - dist / 20 * 10.5, dist, dist);\n    } catch (e) { }\n  }\n\n  /**\n   * 太陽眼鏡\n   * @param {array} points \n   */\n  drawGlasses(points) {\n    try {\n      // 兩眼最遠距離作為圖片大小\n      const p1 = points.faceLandmarks.positions[36];\n      const p2 = points.faceLandmarks.positions[45];\n      const dist = Math.sqrt(Math.pow((p1.x - p2.x), 2) + Math.pow((p1.x - p2.x), 2), 0.5) * 1.2;\n      // 眉心位置\n      const { x, y } = points.faceLandmarks.positions[27];\n      context.drawImage(GlassesImg, x - dist / 20 * 10, y - dist / 20 * 9, dist, dist);\n    } catch (e) { }\n  }\n\n  /**\n   * 川普頭貼\n   * @param {array} points \n   */\n  drawHead(points) {\n    try {\n      const p1 = points.faceLandmarks.positions[2];\n      const p2 = points.faceLandmarks.positions[15];\n      const dist = Math.sqrt(Math.pow((p1.x - p2.x), 2) + Math.pow((p1.x - p2.x), 2), 0.5);\n      const { x, y } = points.faceLandmarks.positions[29];\n      // eslint-disable-next-line no-undef\n      context.drawImage(HeadImg, x - dist / 20 * 11, y - dist / 20 * 16, dist, dist * HeadImg.height / HeadImg.width);\n    } catch (e) { }\n  }\n\n  /**\n   * 點狀眼睛\n   * @param {array} poitns \n   */\n  drawEyes(poitns) {\n    // 左眼\n    const lp1 = poitns.faceLandmarks.positions[37];\n    const lp2 = poitns.faceLandmarks.positions[41];\n    const lx = (lp1.x + lp2.x) / 2;\n    const ly = (lp1.y + lp2.y) / 2;\n    context.fillStyle = this.state.colorLandmarks;\n    context.fillRect(lx, ly, 20, 20);\n    // 右眼\n    const rp1 = poitns.faceLandmarks.positions[43];\n    const rp2 = poitns.faceLandmarks.positions[47];\n    const rx = (rp1.x + rp2.x) / 2;\n    const ry = (rp1.y + rp2.y) / 2;\n    context.fillStyle = this.state.colorLandmarks;\n    context.fillRect(rx, ry, 20, 20);\n  }\n\n  /**\n   * 血輪眼\n   * @param {array} poitns \n   */\n  drawRedEye(poitns) {\n    // 左眼\n    const lp1 = poitns.faceLandmarks.positions[36];\n    const lp2 = poitns.faceLandmarks.positions[39];\n    context.drawImage(RedEyeImg, lp1.x - 10, lp1.y - 15, 50, 50);\n    // 右眼\n    const rp1 = poitns.faceLandmarks.positions[42];\n    const rp2 = poitns.faceLandmarks.positions[45];\n    context.drawImage(RedEyeImg, rp1.x - 10, rp2.y - 18, 50, 50);\n  }\n\n  /**\n   * 可愛眼睛, 可自動縮放\n   * @param {array} points \n   */\n  drawCuteEyes(points) {\n    try {\n      // 兩眼最遠距離作為圖片大小\n      const p1 = points.faceLandmarks.positions[36];\n      const p2 = points.faceLandmarks.positions[45];\n      const dist = Math.sqrt(Math.pow((p1.x - p2.x), 2) + Math.pow((p1.x - p2.x), 2), 0.5);\n      // 眉心位置\n      const { x, y } = points.faceLandmarks.positions[27];\n      context.drawImage(CuteEyeImg, x - dist / 2, y - dist / 20 * 12, dist, dist);\n    } catch (e) { }\n  }\n\n  resizeCanvasAndResults(dimensions, canvas, results) {\n    const { width, height } = dimensions instanceof HTMLVideoElement\n      ? faceapi.getMediaDimensions(dimensions)\n      : dimensions;\n    canvas.width = width;\n    canvas.height = height;\n\n    // resize detections (and landmarks) in case displayed image is smaller than\n    // original size\n    return results.map(res => res.forSize(width, height));\n  }\n\n  updateTimeStats(timeInMs) {\n    const { forwardTimes } = this.state;\n    this.setState({\n      forwardTimes: [timeInMs].concat(forwardTimes).slice(0, 30)\n    });\n    const avgTimeInMs = this.state.forwardTimes.reduce((total, t) => total + t) / this.state.forwardTimes.length;\n    this.setState({\n      time: Math.round(avgTimeInMs),\n      fps: faceapi.round(1000 / avgTimeInMs),\n    });\n  }\n\n  isFaceDetectionModelLoaded() {\n    return !!this.getCurrentFaceDetectionNet().params\n  }\n\n  getCurrentFaceDetectionNet() {\n    const { selectedFaceDetector, FaceDetector } = this.state;\n    switch (selectedFaceDetector) {\n      case FaceDetector.SSD_MOBILENETV1: return faceapi.nets.ssdMobilenetv1;\n      case FaceDetector.TINY_FACE_DETECTOR: return faceapi.nets.tinyFaceDetector;\n      case FaceDetector.MTCNN: return faceapi.nets.mtcnn;\n      default: return null;\n    }\n  }\n\n  getFaceDetectorOptions() {\n    const { selectedFaceDetector, FaceDetector, minConfidence, inputSize, scoreThreshold, minFaceSize } = this.state;\n    return selectedFaceDetector === FaceDetector.SSD_MOBILENETV1\n      ? new faceapi.SsdMobilenetv1Options({ minConfidence })\n      : (\n        selectedFaceDetector === FaceDetector.TINY_FACE_DETECTOR\n          ? new faceapi.TinyFaceDetectorOptions({ inputSize, scoreThreshold })\n          : new faceapi.MtcnnOptions({ minFaceSize })\n      )\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <h1 className=\"title\">FaceAPI Detection</h1>\n        <Select\n          className=\"select-modes\"\n          value={this.state.selectedMode}\n          onChange={(e) => this.setState({ selectedMode: e })}\n          options={this.state.modes}\n        />\n        <div className=\"face\">\n          <video onPlay={this.onPlay.bind(this)} id=\"inputVideo\" autoPlay muted></video>\n          <canvas id=\"overlay\" />\n          <div className=\"state\" style={{ display: this.state.loading ? 'none' : 'block' }}>\n            <span>Time: {this.state.time} ms</span>\n            <span>Estimated Fps: {this.state.fps}</span>\n          </div>\n          <div className=\"control\" style={{ display: this.state.loading ? 'none' : 'block' }}>\n            <div className=\"item\">\n              <input\n                id=\"lbBoxes\"\n                type=\"checkbox\"\n                checked={this.state.withBoxes}\n                onChange={e => this.setState({ withBoxes: e.target.checked })}\n              /><label htmlFor=\"lbBoxes\">臉部外框</label>\n            </div>\n\n            <div className=\"item\">\n              <input\n                id=\"lbMarks\"\n                type=\"checkbox\"\n                checked={this.state.withFaceLandmarks}\n                onChange={e => this.setState({ withFaceLandmarks: e.target.checked })}\n              />\n              <label htmlFor=\"lbMarks\">臉部輪廓</label>\n\n              <div className=\"color-picker\">\n                <div className=\"swatch\" onClick={() => this.setState({ colorShow: !this.state.colorShow })}>\n                  <div className=\"color\" style={{ backgroundColor: this.state.colorLandmarks }} />\n                </div>\n                {\n                  this.state.colorShow\n                    ?\n                    <div className=\"popover\">\n                      <div\n                        className=\"cover\"\n                        onClick={() => this.setState({ colorShow: false })}\n                      />\n                      <SketchPicker\n                        color={this.state.colorLandmarks}\n                        onChange={color => this.setState({ colorLandmarks: color.hex })}\n                      />\n                    </div>\n                    : null\n                }\n              </div>\n            </div>\n\n            <div className=\"item\">\n              <input\n                id=\"lbLines\"\n                type=\"checkbox\"\n                checked={this.state.withLines}\n                onChange={e => this.setState({ withLines: e.target.checked })}\n              /><label htmlFor=\"lbLines\">特徵連線</label>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}